#!/bin/sh
#===============================================================================
#
#          FILE:  preinst
#
#   DESCRIPTION:  Update preinstall script
#
#       OPTIONS:  install
#          BUGS:  ---
#         NOTES:  ---
#  DEPENDENCIES:  	
#        AUTHOR:  Samuel Weru, samweru@gmail.com
#       COMPANY:  UNDESA
#       VERSION:  ---
#       CREATED:  ---
#      REVISION:  ---
#===============================================================================

set -e

case "$1" in
install)
        
        mkdir -p /opt/bungeni/updates/latest 
        
        ############################
        # Postgresql Back Up 
        ############################
        # tar -czf postgres-data.tar.gz /opt/bungeni/bungeni_apps/postgres-data
        # mv postgres-data.tar.gz /opt/bungeni/updates/latest/
        
        ###########################################################
        # Exist Backup bungeni-xml - start exist, backup data, kill 
        ###########################################################
        # service bungeni_services stop
        # su bungeni -l -c "JAVA_HOME=$JAVA_HOME java -Xms128m -Xmx512m \
        #        -Dfile.encoding=UTF-8 \
        #        -Djava.endorsed.dirs=/opt/bungeni/bungeni_apps/exist/lib/endorse \
        #        -Dexist.home=/opt/bungeni/bungeni_apps/exist \
        #        -Djetty.port=8088 \
        #        -jar /opt/bungeni/bungeni_apps/exist/start.jar jetty"
        #
        # su bungeni -l -c "JAVA_HOME=$JAVA_HOME /opt/bungeni/bungeni_apps/exist/bin/backup.sh -b /db/bungeni-xml -d /opt/bungeni/updates/latest"
        # su bungeni -l -c "JAVA_HOME=$JAVA_HOME /opt/bungeni/bungeni_apps/exist/bin/backup.sh -b /db/bungeni-atts -d /opt/bungeni/updates/latest"
        # pkill -u bungeni
    ;;
*)

        echo "prerm called with unknown argument \`$1'" >&2
        exit 0
    ;;
esac

exit 0
